
<!doctype html>
<html lang="en" prefix="og: https://ogp.me/ns#">
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0J2P9316N6"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-0J2P9316N6');
</script>
<meta charset="utf-8"/>
<title>Integrating with Model Context Protocol (MCP) - Keycloak</title>
<meta name="twitter:card" content="summary_large">
<meta name="twitter:site" content="@keycloak">
<meta property="og:site_name" content="Keycloak">
<meta property="og:title" content="Integrating with Model Context Protocol (MCP)">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" property="og:description" content="Using Keycloak as an authorization server for Model Context Protocol (MCP) servers.">
<meta name="author" content="Keycloak Team">
<meta name="keywords" content="sso,idm,openid connect,saml,kerberos,ldap">
<meta name="robots" content="noindex">
<link href="https://www.keycloak.org/resources/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://www.keycloak.org/resources/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
<link href="https://www.keycloak.org/resources/css/keycloak.css" rel="stylesheet">
<link rel="canonical" href="https://www.keycloak.org/nightly/securing-apps/mcp-authz-server">
<meta property="og:url" content="https://www.keycloak.org/nightly/securing-apps/mcp-authz-server">
<link rel="icon" type="image/x-icon" href="https://www.keycloak.org/resources/favicon.ico">
<link rel="icon" type="image/vnd.microsoft.icon" href="https://www.keycloak.org/resources/favicon.ico">
<link rel="icon" type="image/svg+xml" href="https://www.keycloak.org/resources/favicon.svg"></head>
<body>

<header class="navbar navbar-expand-md bg-light shadow-sm">
<nav class="container-xxl flex-wrap flex-md-no-wrap navbar-light" data-nosnippet>
    <a class="navbar-brand me-3 me-md-4 me-lg-5" href="https://www.keycloak.org/">
        <img style="aspect-ratio: 730/151" class="img-fluid" src="https://www.keycloak.org/resources/images/logo.svg" width="240" alt="Keycloak"/>
    </a>
    <a class="nav-link d-none d-sm-block d-md-none d-lg-block" href="https://github.com/keycloak/keycloak"><img src="https://www.keycloak.org/resources/images/stars-large.svg" style="height: 25px; aspect-ratio: 128/20" alt="GitHub stars"/></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="fa fa-bars fa-lg px-1 py-2"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav flex-row flex-wrap bd-navbar-nav pt-2 py-md-0">
        <li class="nav-item col-6 col-md-auto">
          <a class="nav-link " href="https://www.keycloak.org/guides">Guides</a>
        </li>
        <li class="nav-item col-6 col-md-auto">
          <a class="nav-link " href="https://www.keycloak.org/documentation">Docs</a>
        </li>
        <li class="nav-item col-6 col-md-auto">
          <a class="nav-link " href="https://www.keycloak.org/downloads">Downloads</a>
        </li>
        <li class="nav-item col-6 col-md-auto">
          <a class="nav-link " href="https://www.keycloak.org/community">Community</a>
        </li>
        <li class="nav-item col-6 col-md-auto">
          <a class="nav-link " href="https://www.keycloak.org/blog">Blog</a>
        </li>
      </ul>
    </div>
    <div class="d-block d-sm-none d-md-block d-lg-none text-center vw-100">
        <a class="nav-link d-inline p-0" href="https://github.com/keycloak/keycloak"><img src="https://www.keycloak.org/resources/images/stars-large.svg" style="height: 25px; aspect-ratio: 128/20" alt="GitHub stars"/></a>
    </div>
</nav>
</header>


<div class="container mt-5 kc-article">
    <div class="row">
        <div class="col-md-9 col-xl-10 col-sm-12">
            <div class="d-flex align-items-center mb-3">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item"><a href="https://www.keycloak.org/nightly/guides">Guides</a></li>
                        <li class="breadcrumb-item"><a href="https://www.keycloak.org/nightly/guides#securing-apps">Securing applications</a></li>
                        <li class="breadcrumb-item active">Integrating with Model Context Protocol (MCP)</li>
                    </ol>
                </nav>
            </div>

                <div class="mb-4 alert alert-warning" role="alert">
                  <h4 class="no-top-margin">Nightly release</h4>

                  This guide is for the unstable nightly release, for the latest release go <a href="https://www.keycloak.org/securing-apps/mcp-authz-server">here</a>.
                </div>

            <div class="mb-4">
                <div data-nosnippet class="me-3 float-end">
                    <select aria-label="Version" onchange="location = this.options[this.selectedIndex].value;" class="form-select">
                        <option value="https://www.keycloak.org/nightly/securing-apps/mcp-authz-server" selected="selected">Nightly</option>
                        <option value="https://www.keycloak.org/securing-apps/mcp-authz-server" >26.5.2</option>
                    </select>
                </div>

                <h1>Integrating with Model Context Protocol (MCP)</h1>
                    <span class="text-muted">Using Keycloak as an authorization server for Model Context Protocol (MCP) servers.</span>
            </div>



            <div class="kc-asciidoc" id="guide-body">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>There are currently four versions of the Model Context Protocol (MCP) specification:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>2025-11-25 (latest version)</p>
</li>
<li>
<p>2025-06-18</p>
</li>
<li>
<p>2025-03-26</p>
</li>
<li>
<p>2024-11-05 (initial version)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The initial version (2024-11-05) does not cover authorization, as such is not covered in this guide.</p>
</div>
<div class="paragraph">
<p>This guide shows you the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Which MCP version Keycloak supports.</p>
</li>
<li>
<p>How to set up Keycloak as an authorization server in MCP.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, the guide does not cover everything you need to know. Therefore, you are recommended to read the authorization section of the relevant MCP version as well.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_standards_compliance_mcp_requires"><a class="anchor" href="#_standards_compliance_mcp_requires"></a>Standards Compliance MCP requires</h2>
<div class="sectionbody">
<div class="paragraph">
<p>According to the <a href="https://modelcontextprotocol.io/specification/draft/basic/authorization#standards-compliance">MCP specification</a>, there are several standards regarding an authorization server in MCP. The following table shows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Which MCP version requires an authorization server to support which standards in which level (MUST, SHOULD, MAY).</p>
</li>
<li>
<p>With which standards Keycloak complies.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Standard</th>
<th class="tableblock halign-left valign-top">2025-11-25</th>
<th class="tableblock halign-left valign-top">2025-06-18</th>
<th class="tableblock halign-left valign-top">2025-03-26</th>
<th class="tableblock halign-left valign-top">Keycloak</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-1-14">The OAuth 2.1 Authorization Framework (Internet Draft)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MUST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MUST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MUST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://datatracker.ietf.org/doc/html/rfc8414">OAuth 2.0 Authorization Server Metadata (RFC 8414)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MUST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MUST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MUST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://datatracker.ietf.org/doc/html/rfc8707">Resource Indicators for OAuth 2.0 (RFC 8707)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MUST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MUST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://datatracker.ietf.org/doc/html/rfc7591">OAuth 2.0 Dynamic Client Registration Protocol (RFC 7591)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHOULD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHOULD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-client-id-metadata-document-00">OAuth Client ID Metadata Document (Internet Draft)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHOULD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not supported</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The MCP specification adopts <a href="https://datatracker.ietf.org/doc/html/rfc9728">OAuth 2.0 Protected Resource Metadata (RFC 9728)</a>. The standard is for an MCP server and not for an authorization server like Keycloak. Therefore, it is not included in the above table.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mcp_version_compliance"><a class="anchor" href="#_mcp_version_compliance"></a>MCP version compliance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this guide, as criteria for compliance, "Keycloak supports MCP" means that Keycloak meets all MUST and SHOULD requirements by MCP.</p>
</div>
<div class="paragraph">
<p>According to these criteria, the following table shows which MCP version Keycloak supports.</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">MCP Version</th>
<th class="tableblock halign-left valign-top">Conformance</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://modelcontextprotocol.io/specification/2025-03-26/basic/authorization">2025-03-26</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supported</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://modelcontextprotocol.io/specification/2025-06-18/basic/authorization">2025-06-18</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Partially Supported without Resource Indicators for OAuth 2.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://modelcontextprotocol.io/specification/2025-11-25/basic/authorization">2025-11-25</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Partially Supported without Resource Indicators for OAuth 2.0 and OAuth Client ID Metadata Document</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_setup"><a class="anchor" href="#_setup"></a>Setup</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_for_mcp_2025_03_26"><a class="anchor" href="#_for_mcp_2025_03_26"></a>For MCP 2025-03-26</h3>
<div class="paragraph">
<p>No special setup is required.</p>
</div>
</div>
<div class="sect2">
<h3 id="_for_mcp_2025_06_18_and_2025_11_25"><a class="anchor" href="#_for_mcp_2025_06_18_and_2025_11_25"></a>For MCP 2025-06-18 and 2025-11-25</h3>
<div class="sect3">
<h4 id="_token_audience_binding_and_validation"><a class="anchor" href="#_token_audience_binding_and_validation"></a>Token Audience Binding and Validation</h4>
<div class="paragraph">
<p>To gain security benefit, the MCP specification requires an access token to be bound with its audience. In order to do so, the MCP specification requires the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An MCP client MUST include the <code>resource</code> parameter defined in <a href="https://datatracker.ietf.org/doc/html/rfc8707">Resource Indicators for OAuth 2.0 (RFC 8707)</a> in an authorization request and token request. The parameter&#8217;s value MUST identify an MCP server that the MCP client intends to use the token with.</p>
</li>
<li>
<p>An MCP server MUST validate that tokens presented to them were specifically issued for their use.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The MCP specification does not describe how to do this binding. One method for the binding is to set a value of <code>resource</code> parameter to an <code>aud</code> claim in an access token. However, Keycloak cannot recognize <code>resource</code> parameter.</p>
</div>
<div class="paragraph">
<p>The Keycloak community is planning to support Resource Indicators for OAuth 2.0 (RFC 8707) to Keycloak to make Keycloak recognize and process the <code>resource</code> parameter as the MCP specification expects. Until this support is completed, you can use OAuth 2.0&#8217;s <code>scope</code> parameter instead of the <code>resource</code> parameter. To show the binding, please consider the following situation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An MCP server&#8217;s URL is <code>https://example.com/mcp</code></p>
</li>
<li>
<p>The MCP supports the following three scopes: <code>mcp:tools</code>, <code>mcp:prompts</code> and  <code>mcp:resources</code>.</p>
</li>
<li>
<p>To get an access token for accessing the MCP server, an MCP client sends to Keycloak an authorization request whose <code>resource</code> parameter value is <code>https://example.com/mcp</code> and <code>scope</code> parameter includes any combination of the three scopes.</p>
</li>
<li>
<p>We want Keycloak to issue an access token whose <code>aud</code> claim&#8217;s value is MCP server&#8217;s URL, namely <code>https://example.com/mcp</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To make Keycloak issue such the access token, we could configure Keycloak as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add a client scope <code>mcp:tools</code> whose type is <code>Optional</code>.</p>
</li>
<li>
<p>Add to the client scope a new <code>Audience</code> mapper whose <code>Included Custom Audience</code> field is <code>https://example.com/mcp</code>.</p>
</li>
<li>
<p>Add a client scope <code>mcp:prompts</code> whose type is <code>Optional</code>.</p>
</li>
<li>
<p>Add to the client scope a new <code>Audience</code> mapper whose <code>Included Custom Audience</code> field is <code>https://example.com/mcp</code>.</p>
</li>
<li>
<p>Add a client scope <code>mcp:resources</code> whose type is <code>Optional</code>.</p>
</li>
<li>
<p>Add to the client scope a new <code>Audience</code> mapper whose <code>Included Custom Audience</code> field is <code>https://example.com/mcp</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please not that the client scope&#8217;s <code>Included Custom Audience</code> field needs to be the same as the authorization request&#8217;s <code>resource</code> parameter value and the MCP server&#8217;s URL.</p>
</div>
<div class="paragraph">
<p>With the configuration, if the MCP client send to Keycloak an authorization request whose <code>resource</code> parameter value is <code>https://example.com/mcp</code> and <code>scope</code> parameter includes <code>mcp:resources</code>, <code>mcp:tools</code> and <code>mcp:prompts</code>, Keycloak can issue the following access token:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  ...
  "aud": "https://example.com/mcp",
  "scope": "mcp:resources mcp:tools mcp:prompts"
  ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mcp_inspector_integration"><a class="anchor" href="#_mcp_inspector_integration"></a>MCP Inspector integration</h3>
<div class="paragraph">
<p>If you want to use <a href="https://github.com/modelcontextprotocol/inspector">MCP Inspector</a>, an official debugging tools for MCP server, with Keycloak as an authorization server, you need to do an appropriate setup regarding CORS on Keycloak&#8217;s' client registration endpoint because MCP Inspector executes JavaScript downloaded from the MCP Inspector&#8217;s backend server to register an MCP client dynamically to Keycloak.</p>
</div>
<div class="paragraph">
<p>You need to do an appropriate setup for Client Registration&#8217;s anonymous access policies as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Allowed Client Scopes: Needs to include scopes supported by an MCP server.</p>
</li>
<li>
<p>Allowed Registration Web Origins: Needs to include web origin of MCP inspector&#8217;s backend server.</p>
</li>
<li>
<p>Trusted Hosts: Needs to include hostname or IP address of the machine that sends a dynamic client registration request to Keycloak, namely the machine your browser runs on.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_for_mcp_2025_11_25"><a class="anchor" href="#_for_mcp_2025_11_25"></a>For MCP 2025-11-25</h3>
<div class="sect3">
<h4 id="_client_registration"><a class="anchor" href="#_client_registration"></a>Client Registration</h4>
<div class="paragraph">
<p>According to <a href="https://modelcontextprotocol.io/specification/2025-11-25/basic/authorization#client-registration-approaches">Client Registration Approaches</a> section of the MCP specification, the following three client registration mechanisms are supported and you can choose based on your scenario:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Client ID Metadata Documents: When client and server have no prior relationship (most common)</p>
</li>
<li>
<p>Pre-registration: When client and server have an existing relationship</p>
</li>
<li>
<p>Dynamic Client Registration: For backwards compatibility or specific requirements</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Keycloak community is planning to support OAuth Client ID Metadata Document in the future. Until the support is completed, Keycloak can still accommodate an MCP client by pre-registration or Dynamic Client Registration.</p>
</div>
</div>
</div>
</div>
</div>            </div>
        </div>

        <div class="col-md-3 mt-4 col-xl-2 col-sm-12 bg-light">
            <div class="sticky-top px-2 py-3">
                <div class="mt-2 mb-2 fw-bold">On this page</div>
                <div id="js-toc"></div>
                <div class="mt-4">
                    <a href="https://github.com/keycloak/keycloak/tree/main/docs/guides/securing-apps/mcp-authz-server.adoc" target="_blank"><i class="fa fa-edit"></i> Edit this guide</a>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://www.keycloak.org/resources/js/guide.js" type="text/javascript"></script>


<div class="container mt-5" data-nosnippet>
    <footer class="py-3 my-4 border-top">
        <p class="text-center text-muted">Keycloak is a Cloud Native Computing Foundation incubation project</p>
        <div class="text-center">
            <img style="aspect-ratio: 300/48" alt="Cloud Native Computing Foundation" src="https://www.keycloak.org/resources/images/cncf_logo.png" loading="lazy"/>
        </div>
        <p class="mt-4 text-center small text-muted">&copy; Keycloak Authors 2025. &copy; 2025 The Linux Foundation. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage">Trademark Usage page</a>.</p>
    </footer>
</div>

<script src="https://www.keycloak.org/resources/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
<script src="https://www.keycloak.org/resources/tocbot/dist/tocbot.min.js" type="text/javascript"></script>
</body>
</html>
