
<!doctype html>
<html lang="en" prefix="og: https://ogp.me/ns#">
<head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0J2P9316N6"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-0J2P9316N6');
</script>
<meta charset="utf-8"/>
<title>Setting Up Keycloak as a Credential Issuer with OpenID4VCI - Keycloak</title>
<meta name="twitter:card" content="summary_large">
<meta name="twitter:site" content="@keycloak">
<meta property="og:site_name" content="Keycloak">
<meta property="og:title" content="Setting Up Keycloak as a Credential Issuer with OpenID4VCI">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" property="og:description" content="Keycloak can act as a verifiable credential issuer using OpenID4VCI, allowing users to receive verifiable credentials as digital proofs of identity. This guide walks through the required configuration steps.">
<meta name="author" content="Rodrick Awambeng, Forkim Enjeckayang, Ingrid Kamga, Bertrand Ogen">
<meta name="keywords" content="sso,idm,openid connect,saml,kerberos,ldap">
<link href="https://www.keycloak.org/resources/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://www.keycloak.org/resources/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
<link href="https://www.keycloak.org/resources/css/keycloak.css" rel="stylesheet">
<link rel="canonical" href="https://www.keycloak.org/2026/01/issue-credentials-over-openid4vci">
<meta property="og:url" content="https://www.keycloak.org/2026/01/issue-credentials-over-openid4vci">
<link rel="icon" type="image/x-icon" href="https://www.keycloak.org/resources/favicon.ico">
<link rel="icon" type="image/vnd.microsoft.icon" href="https://www.keycloak.org/resources/favicon.ico">
<link rel="icon" type="image/svg+xml" href="https://www.keycloak.org/resources/favicon.svg">
<link rel="alternate" type="application/rss+xml" title="Keycloak's Blog" href="https://www.keycloak.org/rss.xml">
<script type="application/ld+json">
{"@context":"https://schema.org/","@type":"BlogPosting","@id":"https://www.keycloak.org/2026/01/issue-credentials-over-openid4vci","headline":"Setting Up Keycloak as a Credential Issuer with OpenID4VCI","name":"Setting Up Keycloak as a Credential Issuer with OpenID4VCI","datePublished":"2026-01-16T08:00:00Z","inLanguage":"en","abstract":"Keycloak can act as a verifiable credential issuer using OpenID4VCI, allowing users to receive verifiable credentials as digital proofs of identity. This guide walks through the required configuration steps.","url":"https://www.keycloak.org/2026/01/issue-credentials-over-openid4vci","publisher":{"@type":"Organization","@id":"https://keycloak.org","name":"Keycloak"},"author":[{"@type":"Person","name":"Rodrick Awambeng"},{"@type":"Person","name":"Forkim Enjeckayang"},{"@type":"Person","name":"Ingrid Kamga"},{"@type":"Person","name":"Bertrand Ogen"}]}
</script></head>
<body>

<header class="navbar navbar-expand-md bg-light shadow-sm">
<nav class="container-xxl flex-wrap flex-md-no-wrap navbar-light" data-nosnippet>
    <a class="navbar-brand me-3 me-md-4 me-lg-5" href="https://www.keycloak.org/">
        <img style="aspect-ratio: 730/151" class="img-fluid" src="https://www.keycloak.org/resources/images/logo.svg" width="240" alt="Keycloak"/>
    </a>
    <a class="nav-link d-none d-sm-block d-md-none d-lg-block" href="https://github.com/keycloak/keycloak"><img src="https://www.keycloak.org/resources/images/stars-large.svg" style="height: 25px; aspect-ratio: 128/20" alt="GitHub stars"/></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="fa fa-bars fa-lg px-1 py-2"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav flex-row flex-wrap bd-navbar-nav pt-2 py-md-0">
        <li class="nav-item col-6 col-md-auto">
          <a class="nav-link " href="https://www.keycloak.org/guides">Guides</a>
        </li>
        <li class="nav-item col-6 col-md-auto">
          <a class="nav-link " href="https://www.keycloak.org/documentation">Docs</a>
        </li>
        <li class="nav-item col-6 col-md-auto">
          <a class="nav-link " href="https://www.keycloak.org/downloads">Downloads</a>
        </li>
        <li class="nav-item col-6 col-md-auto">
          <a class="nav-link " href="https://www.keycloak.org/community">Community</a>
        </li>
        <li class="nav-item col-6 col-md-auto">
          <a class="nav-link " href="https://www.keycloak.org/blog">Blog</a>
        </li>
      </ul>
    </div>
    <div class="d-block d-sm-none d-md-block d-lg-none text-center vw-100">
        <a class="nav-link d-inline p-0" href="https://github.com/keycloak/keycloak"><img src="https://www.keycloak.org/resources/images/stars-large.svg" style="height: 25px; aspect-ratio: 128/20" alt="GitHub stars"/></a>
    </div>
</nav>
</header>


<div class="container mt-5 kc-article kc-asciidoc">
    <h1>Setting Up Keycloak as a Credential Issuer with OpenID4VCI</h1>
    <p class="blog-date text-muted">January 16 2026 by Rodrick Awambeng, Forkim Enjeckayang, Ingrid Kamga, Bertrand Ogen</p>


<div class="paragraph">
<p>Before configuring Keycloak, it is helpful to understand its role in decentralized identity ecosystems. As a verifiable credential issuer, Keycloak can issue digitally signed credentials using the <a href="https://openid.net/specs/openid-4-verifiable-credential-issuance-1_0.html">OpenID for Verifiable Credential Issuance</a> (OpenID4VCI) protocol, allowing relying parties (also known as verifiers) to independently verify them without contacting the issuer.</p>
</div>
<div class="paragraph">
<p>Keycloak implements OpenID4VCI, enabling the issuance of verifiable credentials (VCs) as digital proofs of identity or attributes. Configuring this functionality requires consistent setup across the realm, clients, and issuable credentials (client scopes).</p>
</div>
<div class="paragraph">
<p>For example, consider the following scenario: The <a href="https://github.com/keycloak/keycloak-oauth-sig">Keycloak OAuth SIG team</a> wants to issue verifiable membership credentials to its members, including their name and email, which can later be presented at onsite or virtual events as proof of active membership.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
At the time of writing this blog, Keycloak&#8217;s support for OpenID4VCI is still experimental. This guide uses the <a href="https://www.keycloak.org/downloads.html"><strong>Keycloak 26.5.0 release</strong></a>. The feature is under active development and is expected to be promoted to preview in the future.
</td>
</tr>
</table>
</div>
<div class="sect1">
<h2 id="_introduction_to_openid4vci_openid4vp"><a class="anchor" href="#_introduction_to_openid4vci_openid4vp"></a>Introduction to OpenID4VCI &amp; OpenID4VP</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenID4VCI is a protocol developed by the OpenID Foundation that extends the OAuth 2.0 framework to support the secure and interoperable issuance of Verifiable Credentials (VCs). VCs are digital, tamper-evident representations of information, such as identity attributes or qualifications, which can be cryptographically verified without needing to contact the issuer at verification time.</p>
</div>
<div class="paragraph">
<p>While this guide primarily focuses on <strong>OpenID for Verifiable Credential Issuance (OpenID4VCI)</strong>, the overall trust architecture also includes <strong>OpenID for Verifiable Presentations (OpenID4VP)</strong>, which governs how holders present credentials to verifiers. Together, these protocols enable decentralized identity ecosystems in which users (holders) retain control of their data and can share it selectively with verifiers.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://www.keycloak.org/resources/images/blog/openid4vci/triangle-of-trust.png" alt="Triangle of trust or Issuer-Holder-Verifier model" width="800">
</div>
<div class="title">Figure 1. Triangle of trust or Issuer-Holder-Verifier model</div>
</div>
<div class="paragraph">
<p>In this model:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Issuer ↔ Holder</strong> interactions are governed by <strong>OpenID4VCI</strong>, covering credential issuance.</p>
</li>
<li>
<p><strong>Holder ↔ Verifier</strong> interactions are governed by <strong>OpenID4VP</strong>, covering credential presentation and verification.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>From a privacy perspective, this separation of concerns is fundamental. By decoupling <strong>credential issuance</strong> from <strong>credential presentation</strong>, issuers are unable to track where, when, or how a holder uses their credentials. This architecture prevents correlation and profiling, and ensures that users remain in control of how their data is shared.</p>
</div>
<div class="sect2">
<h3 id="_why_use_openid4vci"><a class="anchor" href="#_why_use_openid4vci"></a>Why Use OpenID4VCI</h3>
<div class="paragraph">
<p>The primary motivations for adopting OpenID4VCI include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Interoperability</strong>: Builds on established OpenID Connect (OIDC) standards, simplifying integration with existing identity providers.</p>
</li>
<li>
<p><strong>Privacy and Security</strong>: Supports selective disclosure (e.g., proving age without revealing birthdate) and offline verification.</p>
</li>
<li>
<p><strong>Compliance</strong>: Aligned with regulations like eIDAS 2.0.</p>
</li>
<li>
<p><strong>Efficiency</strong>: Leverages OIDC mechanisms to streamline issuance while maintaining trust in the "triangle of trust" model (Issuer-Holder-Verifier).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_verifiable_credential_formats"><a class="anchor" href="#_verifiable_credential_formats"></a>Verifiable Credential Formats</h3>
<div class="paragraph">
<p>OpenID4VCI supports multiple credential formats, which define how verifiable credentials are encoded and issued.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.ietf.org/archive/id/draft-ietf-oauth-sd-jwt-vc-13.html">SD-JWT VC</a> – Selective Disclosure JSON Web Token Verifiable Credential</p>
</li>
<li>
<p><a href="https://identity.foundation/jwt-vc-presentation-profile/">JWT VC</a> – JSON Web Token Verifiable Credential</p>
</li>
<li>
<p><a href="https://www.iso.org/standard/69084.html">mDL/mdoc</a> – Mobile driver’s license / mobile document format</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These formats allow issuers to provide portable, verifiable digital proofs that support selective disclosure and offline verification in decentralized identity ecosystems.</p>
</div>
<div class="paragraph">
<p><strong>Keycloak currently supports both SD-JWT VC and JWT VC for issuance</strong>. mDL/mdoc, which is part of the OpenID4VCI specification, is expected to be supported in the future.</p>
</div>
</div>
<div class="sect2">
<h3 id="_concrete_use_cases_enabled_by_openid4vci"><a class="anchor" href="#_concrete_use_cases_enabled_by_openid4vci"></a>Concrete Use-Cases Enabled by OpenID4VCI</h3>
<div class="paragraph">
<p>Verifiable credentials open a variety of real-world applications. Examples include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Governments or non-government organisations issuing digital identity cards or driver’s licenses that citizens can present when booking hotels, opening bank accounts, or accessing public services, while revealing only the information necessary for the transaction (e.g., age or residency) without exposing full personal details.</p>
</li>
<li>
<p>City councils issuing verifiable birth certificates that universities and hospitals can validate without a central lookup.</p>
</li>
<li>
<p>Universities issuing digital diplomas that employers can instantly verify for authenticity.</p>
</li>
<li>
<p>Companies issuing employee badges as verifiable credentials for office access or remote authentication.</p>
</li>
<li>
<p>Event organizers issuing verifiable tickets that can be validated offline.</p>
</li>
<li>
<p>Professional associations issuing membership credentials such as in our OAuth SIG example for verifying access to gated resources or conference venues.</p>
</li>
<li>
<p>Digital movie or event tickets that are tamper-evident and can be verified offline.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These examples illustrate the variety of situations where verifiable credentials remove the need for direct communication between verifier and issuer while preserving trust.</p>
</div>
</div>
<div class="sect2">
<h3 id="_key_flows_in_openid4vci"><a class="anchor" href="#_key_flows_in_openid4vci"></a>Key Flows in OpenID4VCI</h3>
<div class="paragraph">
<p>OpenID4VCI defines two primary flows for credential issuance: the <strong>Authorization Code Flow</strong> and the <strong>Pre-Authorized Code Flow</strong>. These flows determine how a wallet (holder’s application) obtains an access token to request a VC from the issuer.</p>
</div>
<div class="sect3">
<h4 id="_authorization_code_flow"><a class="anchor" href="#_authorization_code_flow"></a>Authorization Code Flow</h4>
<div class="paragraph">
<p>The Authorization Code Flow is <strong>interactive</strong> and requires the holder to authenticate and consent at the issuer’s authorization endpoint. It is ideal for scenarios where explicit user approval is required, or additional claims must be collected.</p>
</div>
<div class="paragraph">
<p><strong>Steps:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <strong>Wallet</strong> sends an Authorization Request to the <strong>Issuer’s Authorization Endpoint</strong>, requesting credentials.</p>
</li>
<li>
<p>The <strong>Issuer</strong> authenticates the <strong>User</strong> and requests consent for the issuance.</p>
</li>
<li>
<p>The <strong>User</strong> provides credentials and grants consent.</p>
</li>
<li>
<p>The <strong>Issuer</strong> returns an <strong>Authorization Code</strong> to the Wallet.</p>
</li>
<li>
<p>The <strong>Wallet</strong> exchanges the code at the <strong>Issuer Token Endpoint</strong> for an <strong>Access Token</strong>.</p>
</li>
<li>
<p>The <strong>Issuer</strong> returns the <strong>Access Token</strong> to the Wallet.</p>
</li>
<li>
<p>The <strong>Wallet</strong> requests the <strong>Verifiable Credential</strong> from the <strong>Issuer Credential Endpoint</strong> using the Access Token.</p>
</li>
<li>
<p>The <strong>Issuer</strong> returns the <strong>VC</strong> to the Wallet.</p>
</li>
</ol>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://www.keycloak.org/resources/images/blog/openid4vci/authorization-code-flow.png" alt="Credential issuance via Authorization Code Flow" width="800">
</div>
<div class="title">Figure 2. Credential issuance via Authorization Code Flow</div>
</div>
</div>
<div class="sect3">
<h4 id="_pre_authorized_code_flow"><a class="anchor" href="#_pre_authorized_code_flow"></a>Pre-Authorized Code Flow</h4>
<div class="paragraph">
<p>The Pre-Authorized Code Flow is <strong>non-interactive</strong>. The issuer pre-authenticates and authorizes the user, providing a <strong>pre-authorized code</strong> (often via QR code). It is faster and suitable for pre-approved credential issuance.</p>
</div>
<div class="paragraph">
<p><strong>Steps:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <strong>Issuer</strong> provides a <strong>Pre-Authorized Code</strong> to the <strong>Wallet</strong> (e.g., via QR code or link).</p>
</li>
<li>
<p>The <strong>Wallet</strong> exchanges the code at the <strong>Issuer Token Endpoint</strong> for an <strong>Access Token</strong>.</p>
</li>
<li>
<p>The <strong>Issuer</strong> returns the <strong>Access Token</strong> to the Wallet.</p>
</li>
<li>
<p>The <strong>Wallet</strong> requests the <strong>Verifiable Credential</strong> from the <strong>Issuer Credential Endpoint</strong> using the Access Token.</p>
</li>
<li>
<p>The <strong>Issuer</strong> returns the <strong>VC</strong> to the Wallet.</p>
</li>
</ol>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://www.keycloak.org/resources/images/blog/openid4vci/pre-authorized-code-flow.png" alt="Credential issuance via Pre-Authorized Code Flow" width="800">
</div>
<div class="title">Figure 3. Credential issuance via Pre-Authorized Code Flow</div>
</div>
<div class="paragraph">
<p>Now that we have covered the technical flows, the rest of this guide walks through configuring Keycloak to issue verifiable credentials using the <strong>Pre-Authorized Code Flow</strong>, including realm, client scope, and client-level setup.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_keycloak_for_openid4vci"><a class="anchor" href="#_configuring_keycloak_for_openid4vci"></a>Configuring Keycloak for OpenID4VCI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenID4VCI in Keycloak is offered via the feature flag <code>oid4vc-vci</code>, which consequently needs to be enabled at startup.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">--features=oid4vc-vci</code></pre>
</div>
</div>
<div class="paragraph">
<p>That said, we now assume that you have a running Keycloak instance with the <code>oid4vc-vci</code> feature flag enabled.</p>
</div>
<div class="paragraph">
<p>Beyond enabling the feature flag, the following configuration steps need to be taken consistently, in accordance with your use case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure OpenID4VCI at the realm level</p>
</li>
<li>
<p>Configure an issuable verifiable credential (as a dedicated client scope)</p>
</li>
<li>
<p>Enable and configure OpenID4VCI at the client level</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Because some configurations are not yet supported via the Keycloak Admin Console, we may often use the Admin REST API to communicate required configurations.</p>
</div>
<div class="sect2">
<h3 id="_configuring_openid4vci_at_the_realm_level"><a class="anchor" href="#_configuring_openid4vci_at_the_realm_level"></a>Configuring OpenID4VCI at the realm level</h3>
<div class="paragraph">
<p>Let&#8217;s assume you have already created a realm named <code>oauth-sig-realm</code> to represent the OAuth SIG group, and that a couple of users have also been created in this realm, each with a password assigned, to represent members of the group.</p>
</div>
<div class="paragraph">
<p>In addition, any user who is intended to create credential offers must be granted the built-in <code>credential-offer-create</code> role. This role is provided by the OpenID4VCI extension and does not need to be created manually. Assigning it ensures that only authorized users can generate credential offers, maintaining the security of the issuance process.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://www.keycloak.org/resources/images/blog/openid4vci/screenshot-realm-and-users.png" alt="Screenshot: Realm and Users" width="800">
</div>
<div class="title">Figure 4. Screenshot: Realm and Users</div>
</div>
<div class="paragraph">
<p>The behavior of OpenID4VCI across the entire realm can be modulated via realm attributes.
On the Admin Console, find the <strong>OID4VCI Attributes</strong> section under the <strong>Realm Settings &gt; Tokens</strong> tab.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://www.keycloak.org/resources/images/blog/openid4vci/screenshot-realm-config-oid4vci-attributes.png" alt="Screenshot: OID4VCI Attributes" width="800">
</div>
<div class="title">Figure 5. Screenshot: OID4VCI Attributes</div>
</div>
<div class="paragraph">
<p>Sensible defaults apply out of the box, but for the sake of this demo, we would want, for instance, to increase the value of <strong>Pre-Authorized Code Lifespan</strong> to 3 minutes so that the issuance flow expires less quickly.
To learn more about the <strong>Nonce Lifetime</strong> and other realm attributes for OpenID4VCI, please refer to the main <a href="https://www.keycloak.org/docs/26.5.0/server_admin/index.html#_oid4vci">Keycloak documentation</a>.</p>
</div>
<div class="paragraph">
<p>Lastly, because EC cryptography is highly encouraged in the OpenID4VC ecosystem, we also invite you to add a <strong>P-256 Elliptic Curve key pair</strong> to the realm&#8217;s set of keys under <strong>Realm Settings &gt; Keys &gt; Providers</strong>.
This will later enable configuring the signing of issued VCs with algorithm <code>ES256</code>.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://www.keycloak.org/resources/images/blog/openid4vci/screenshot-realm-ecdsa-generated-provider.png" alt="Screenshot: Adding ECDSA Key Provider" width="800">
</div>
<div class="title">Figure 6. Screenshot: Adding ECDSA Key Provider</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_an_issuable_verifiable_credential_as_a_dedicated_client_scope"><a class="anchor" href="#_configuring_an_issuable_verifiable_credential_as_a_dedicated_client_scope"></a>Configuring an issuable verifiable credential (as a dedicated client scope)</h3>
<div class="paragraph">
<p>Different credential types can be configured for issuance depending on what data the credential should embed, what format it should have, or other criteria.
Each credential type is configured as a dedicated client scope of protocol type "OpenID for Verifiable Credentials".</p>
</div>
<div class="paragraph">
<p>We will configure our membership credential to be issued as an SD-JWT credential carrying a user&#8217;s first name, last name, and email.
Each claim to be added to the credential requires a corresponding protocol mapper from the User Model to the credential.
Other fields such as the time of issuance or a unique identifier for the credential are supported via other types of protocol mappers.</p>
</div>
<div class="paragraph">
<p>Since we will be using the Admin REST API to configure the client scope, we first need to obtain a valid Admin Token from the <code>master</code> realm to authorize our requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">ADMIN_TOKEN=$(curl -s -X POST "http://&lt;keycloak.instance&gt;/realms/master/protocol/openid-connect/token" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=&lt;admin-username&gt;" \
  -d "password=&lt;admin-password&gt;" \
  -d "grant_type=password" \
  -d "client_id=admin-cli" | jq -r '.access_token' )
echo "Admin Token obtained: $ADMIN_TOKEN"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, let&#8217;s proceed with adding the membership credential type as a dedicated client scope using the Admin REST API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">curl -X POST "http://&lt;keycloak.instance&gt;/admin/realms/oauth-sig-realm/client-scopes" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $ADMIN_TOKEN" \
  -d '{
    "name": "membership-credential",
    "protocol": "oid4vc",
    "attributes": {
      "include.in.token.scope": "true",
      "vc.format": "dc+sd-jwt",
      "vc.verifiable_credential_type": "https://credentials.example.com/oauth-sig-membership",
      "vc.credential_signing_alg": "ES256",
      "vc.display": "[{\"name\": \"OAuth SIG Membership\", \"locale\":\"en\"}]",
      "vc.credential_build_config.token_jws_type": "dc+sd-jwt"
    },
    "protocolMappers": [
      {
        "name": "given_name-mapper",
        "protocol": "oid4vc",
        "protocolMapper": "oid4vc-user-attribute-mapper",
        "config": {
          "claim.name": "given_name",
          "userAttribute": "firstName",
          "vc.display": "[{\"name\":\"Given Name\",\"locale\":\"en\"}]"
        }
      },
      {
        "name": "family_name-mapper",
        "protocol": "oid4vc",
        "protocolMapper": "oid4vc-user-attribute-mapper",
        "config": {
          "claim.name": "family_name",
          "userAttribute": "lastName",
          "vc.display": "[{\"name\":\"Family Name\",\"locale\":\"en\"}]"
        }
      },
      {
        "name": "email-mapper",
        "protocol": "oid4vc",
        "protocolMapper": "oid4vc-user-attribute-mapper",
        "config": {
          "claim.name": "email",
          "userAttribute": "email",
          "vc.display": "[{\"name\":\"Email\",\"locale\":\"en\"}]"
        }
      },
      {
        "name": "iat-mapper",
        "protocol": "oid4vc",
        "protocolMapper": "oid4vc-issued-at-time-claim-mapper",
        "config": {
          "claim.name": "iat",
          "truncateToTimeUnit": "HOURS",
          "valueSource": "COMPUTE"
        }
      }
    ]
  }'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Commenting on the above configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>vc.format</code> attribute defines the credential format (e.g. <code>dc+sd-jwt</code>).</p>
</li>
<li>
<p>The <code>vc.verifiable_credential_type</code> attribute defines the value of the <code>vct</code> claim inside the credential.</p>
</li>
<li>
<p>The <code>vc.credential_signing_alg</code> attribute specifies the cryptographic algorithm used to sign the credential.</p>
</li>
<li>
<p>All <code>vc.display</code> entries are intended to be used by a wallet to display intelligible descriptions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To learn more about other used or available configuration attributes, please refer to the main <a href="https://github.com/keycloak/keycloak/blob/main/docs/documentation/server_admin/topics/oid4vci/vc-issuer-configuration.adoc#create-client-scopes-with-mappers">Keycloak documentation</a>.</p>
</div>
<div class="paragraph">
<p>Verify that the client scope was created successfully by checking the Admin Console under <strong>Client Scopes</strong>.</p>
</div>
<div class="paragraph">
<p>Additionally, check the Credential Issuer Metadata Endpoint by navigating to <strong>Realm Settings</strong>, toggling the <strong>Verifiable Credentials</strong> option, and saving the changes. Once done, the endpoint will be listed, allowing you to verify that the newly created credential type appears among the issuable credentials, as shown below.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://www.keycloak.org/resources/images/blog/openid4vci/screenshot-realm-verifiable-credentials.png" alt="Enable Verifiable Credentials in Realm Settings" width="800">
</div>
<div class="title">Figure 7. Screenshot: Enable Verifiable Credentials in Realm Settings</div>
</div>
<div class="paragraph">
<p>The credential type should appear in the metadata like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json5" data-lang="json5">{
  // ...
  "credential_configurations_supported": {
    "membership-credential": {
      "id": "membership-credential",
      "format": "dc+sd-jwt",
      "scope": "membership-credential",
      "cryptographic_binding_methods_supported": [
        "jwk"
      ],
      "credential_signing_alg_values_supported": [
        "ES256"
      ],
      "vct": "https://credentials.example.com/oauth-sig-membership",
      // ...
    }
  }
  // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_enabling_openid4vci_at_the_client_level"><a class="anchor" href="#_enabling_openid4vci_at_the_client_level"></a>Enabling OpenID4VCI at the client level</h3>
<div class="paragraph">
<p>Next, let&#8217;s create a new client in the <code>oauth-sig-realm</code> realm to represent an application that members of the OAuth SIG will use to request and receive their membership credentials.
We will name this client <code>oauth-sig-client</code> and configure it as a standard OpenID Connect client.</p>
</div>
<div class="paragraph">
<p>During client creation, make sure to check the <strong>Direct Access Grants</strong> box, as we will use the <strong>Resource Owner Password Credentials</strong> flow to obtain a user access token in a later step. All other fields are left unchanged.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://www.keycloak.org/resources/images/blog/openid4vci/screenshot-client-creation.png" alt="Screenshot: Client Creation" width="800">
</div>
<div class="title">Figure 8. Screenshot: Client Creation</div>
</div>
<div class="paragraph">
<p>One important point to note is that clients must explicitly enable OpenID4VCI to be able to use it.
Navigate to the <strong>Advanced</strong> tab of the <code>oauth-sig-client</code> client and toggle the <strong>Enable OID4VCI</strong> switch under the <strong>OpenID for Verifiable Credentials</strong> section.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://www.keycloak.org/resources/images/blog/openid4vci/screenshot-client-enable-oid4vci.png" alt="Screenshot: Enable OID4VCI on Client" width="800">
</div>
<div class="title">Figure 9. Screenshot: Enable OID4VCI on Client</div>
</div>
<div class="paragraph">
<p>Finally, we need to assign the previously created <code>membership-credential</code> client scope to the <code>oauth-sig-client</code> client. To do this, navigate to the <strong>Client Scopes</strong> tab of the <code>oauth-sig-client</code> client and add <code>membership-credential</code> as an <strong>Optional Client Scope</strong>.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://www.keycloak.org/resources/images/blog/openid4vci/screenshot-assign-credential-type-to-client.png" alt="Assigning membership-credential client scope to the client" width="800">
</div>
<div class="title">Figure 10. Screenshot: Assigning membership-credential client scope to the client</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_obtaining_a_user_access_token"><a class="anchor" href="#_obtaining_a_user_access_token"></a>Obtaining a User Access Token</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before obtaining the user access token, ensure that the user has the <code>credential-offer-create</code> role, as only users with this role can create credential offers.</p>
</div>
<div class="paragraph">
<p>With the client configured and the user&#8217;s password set, we can now request a <strong>user access token</strong>. This token will later be used to authorize the credential offer request.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">USER_TOKEN=$(curl -s -X POST "http://&lt;keycloak.instance&gt;/realms/oauth-sig-realm/protocol/openid-connect/token" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=&lt;user-username&gt;" \
  -d "password=&lt;user-password&gt;" \
  -d "grant_type=password" \
  -d "client_id=oauth-sig-client" | jq -r '.access_token' )
echo "User Access Token obtained: $USER_TOKEN"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that we have a <strong>user access token</strong> issued to the user with the <code>credential-offer-create</code> role, we can use it to request a credential offer from the issuer in the next step.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_retrieving_a_credential_offer_to_start_the_issuance_flow"><a class="anchor" href="#_retrieving_a_credential_offer_to_start_the_issuance_flow"></a>Retrieving a credential offer to start the issuance flow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For Pre-Authorized Code flows, OpenID4VCI issuance can be initiated by retrieving a credential offer from Keycloak at the Credential Offer Endpoint. The endpoint requires a valid user access token and the username of the target user for whom the pre-authorized offer will be generated.
In our case, we will be using the same user for both credential offer creation and retrieval.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">curl -X GET "http://&lt;keycloak.instance&gt;/realms/oauth-sig-realm/protocol/oid4vc/credential-offer-uri?credential_configuration_id=membership-credential&amp;type=qr-code&amp;username=&lt;username&gt;" \
  -H "Authorization: Bearer $USER_TOKEN" \
  --output credential-offer-qr.png</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Replace <code>&lt;username&gt;</code> with the user you created earlier.
The QR code image is saved as <code>credential-offer-qr.png</code>. Open this file and use your wallet to redeem the credential.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>With the query parameter <code>type=qr-code</code>, the endpoint returns a <strong>direct binary representation of the QR code image</strong>. If omitted, the endpoint returns JSON, which requires extra steps to construct the QR code from the offer data.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://www.keycloak.org/resources/images/blog/openid4vci/qrcode-generation-overview.png" alt="QR Code Generation Overview" width="800">
</div>
<div class="title">Figure 11. QR Code Generation Overview</div>
</div>
<div class="paragraph">
<p>Upon scanning the QR code with a compatible wallet, a membership credential is issued to the requesting user.</p>
</div>
<div class="sect2">
<h3 id="_️_wallet_compatibility_notice"><a class="anchor" href="#_️_wallet_compatibility_notice"></a>⚠️ Wallet Compatibility Notice</h3>
<div class="paragraph">
<p>Keycloak implements the <strong>final OpenID4VCI specification</strong> and includes a limited <strong>Draft-15 compatibility patch</strong> with partial support.</p>
</div>
<div class="paragraph">
<p>Tested Draft-15 wallets that work with the compatibility patch:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Wallet</th>
<th class="tableblock halign-left valign-top">Compatibility</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Heidi Wallet</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅ Works via Draft-15 compatibility patch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Valera Wallet</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅ Works via Draft-15 compatibility patch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Lissi Wallet</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅ Works via Draft-15 compatibility patch</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Full support requires wallets providers to implement the final OpenID4VCI specification.
</td>
</tr>
</table>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="https://www.keycloak.org/resources/images/blog/openid4vci/screenshot-wallet-steps.png" alt="Screenshot: Lissi Wallet Test" width="900">
</div>
<div class="title">Figure 12. Screenshot: Lissi Wallet Test</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_before_you_go"><a class="anchor" href="#_before_you_go"></a>Before You Go</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this blog post, we have illustrated how to set up Keycloak for issuing verifiable credentials over OpenID4VCI, using a simple scenario of issuing membership credentials to members of the <a href="https://github.com/keycloak/keycloak-oauth-sig">Keycloak&#8217;s OAuth SIG group</a>.
We covered the necessary configuration steps at the realm, client scope, and client levels, and demonstrated how to retrieve a credential offer to initiate the issuance flow.</p>
</div>
<div class="paragraph">
<p>If you are looking into streamlining this configuration process for OpenID4VCI in Keycloak, take a look at our <a href="https://github.com/keycloak/keycloak-oauth-sig/tree/main/oid4vci-deployment#readme">OID4VCI Deployment</a> project, which provides solid examples for both the pre-authorization and authorization code flows.
You may also find the <a href="https://github.com/keycloak/keycloak-playground/blob/main/fapi-playground/README.md#oid4vci-demo">Keycloak Playground OID4VCI demo</a> useful as a hands-on demo.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_feedback_discussion"><a class="anchor" href="#_feedback_discussion"></a>Feedback &amp; Discussion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We’d love to hear your thoughts on this guide! You can provide feedback or ask questions through:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Slack: Join the <a href="https://slack.cncf.io/">Cloud Native Computing Foundation (CNCF) Slack</a> and discuss with us in the channel <a href="https://cloud-native.slack.com/channels/keycloak-oauth-sig">#keycloak-oauth-sig</a>.</p>
</li>
<li>
<p>GitHub: Inspect and participate in recent <a href="https://github.com/keycloak/keycloak/discussions?discussions_q=is%3Aopen+oid4vci">OpenID4VCI-related GitHub discussions</a>.
Review existing <a href="https://github.com/keycloak/keycloak/issues?q=is%3Aissue%20state%3Aopen%20label%3Aarea%2Foid4vc">OpenID4VCI-related GitHub issues</a> and feel free to comment on or upvote them, or create a new issue if you have ideas for enhancements or discover a bug.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Your input will help us to improve the OpenID4VCI experience in Keycloak.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_important_note_on_openid4vci_development_status"><a class="anchor" href="#_important_note_on_openid4vci_development_status"></a>Important Note on OpenID4VCI Development Status</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenID4VCI support in Keycloak is still under active development. The instructions and configuration options described in this blog post are based on <strong>Keycloak 26.5.0</strong> and may change in future Keycloak versions as the feature evolves.</p>
</div>
<div class="paragraph">
<p>If you want to explore the latest updates to the OID4VCI feature, you can use the latest <a href="https://www.keycloak.org/nightly/">Keycloak nightly release</a>. However, be aware that the instructions in this blog post may not work with that version.</p>
</div>
</div>
</div></div>


<div class="container mt-5" data-nosnippet>
    <footer class="py-3 my-4 border-top">
        <p class="text-center text-muted">Keycloak is a Cloud Native Computing Foundation incubation project</p>
        <div class="text-center">
            <img style="aspect-ratio: 300/48" alt="Cloud Native Computing Foundation" src="https://www.keycloak.org/resources/images/cncf_logo.png" loading="lazy"/>
        </div>
        <p class="mt-4 text-center small text-muted">&copy; Keycloak Authors 2025. &copy; 2025 The Linux Foundation. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage">Trademark Usage page</a>.</p>
    </footer>
</div>

<script src="https://www.keycloak.org/resources/bootstrap/dist/js/bootstrap.min.js" type="text/javascript"></script>
<script src="https://www.keycloak.org/resources/tocbot/dist/tocbot.min.js" type="text/javascript"></script>
</body>
</html>
